<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Manual · EquationLearning.jl Documentation</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="home.html">EquationLearning.jl Documentation</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="home.html">Home</a></li><li><a class="tocitem" href="paper.html">VandenHeuvel et al. (2022)</a></li><li><a class="tocitem" href="tut.html">Tutorial</a></li><li class="is-active"><a class="tocitem" href="ref.html">Manual</a><ul class="internal"><li><a class="tocitem" href="#Structs"><span>Structs</span></a></li><li><a class="tocitem" href="#Bootstrapping"><span>Bootstrapping</span></a></li><li><a class="tocitem" href="#Gaussian-Processes"><span>Gaussian Processes</span></a></li><li><a class="tocitem" href="#PDEs"><span>PDEs</span></a></li><li><a class="tocitem" href="#Plotting"><span>Plotting</span></a></li><li><a class="tocitem" href="#Data-Generation"><span>Data Generation</span></a></li><li><a class="tocitem" href="#Model-Comparison"><span>Model Comparison</span></a></li></ul></li><li><a class="tocitem" href="index.html">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="ref.html">Manual</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="ref.html">Manual</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DanielVandH/EquationLearning.jl/blob/main/docs/src/ref.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Manual"><a class="docs-heading-anchor" href="#Manual">Manual</a><a id="Manual-1"></a><a class="docs-heading-anchor-permalink" href="#Manual" title="Permalink"></a></h1><p>This section lists some of the docstrings for the functions defined from our module. All functions in this package are documented, though we only the important ones that are likely to be used by a user here. The remaining docstrings in this package are listed in the index section.</p><h2 id="Structs"><a class="docs-heading-anchor" href="#Structs">Structs</a><a id="Structs-1"></a><a class="docs-heading-anchor-permalink" href="#Structs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.GP_Setup" href="#EquationLearning.GP_Setup"><code>EquationLearning.GP_Setup</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GP_Setup</code></pre><p>Setup for the Gaussian processes. See also <a href="ref.html#EquationLearning.fit_GP"><code>fit_GP</code></a> and <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>ℓₓ::Vector{Float64}</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>ℓₓ</code> (defined on a log scale).</li><li><code>ℓₜ::Vector{Float64}</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>ℓₜ</code> (defined on a log scale).</li><li><code>σ::Vector{Float64}</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>σ</code> (defined on a log scale).</li><li><code>σₙ::Vector{Float64}</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>σₙ</code> (defined on a log scale).</li><li><code>GP_Restarts::Int</code>: Number of times to restart the optimiser. See <a href="index.html#EquationLearning.opt_restart!-NTuple{5, Any}"><code>opt_restart!</code></a>.</li><li><code>μ::Union{Missing, Vector{Float64}}</code>: Either <code>Nothing</code> or a stored mean vector for the Gaussian process. </li><li><code>L::Union{Missing, LowerTriangular{Float64}}</code>: Either <code>Nothing</code> or a stored Cholesky factor for the Gaussian process.</li><li><code>nugget::Float64</code>: Nugget term to add to the covariance matrix to be symmetric positive definite. This nugget is adapted to the blocks of the matrix based on the derivatives, as described in our paper.</li><li><code>gp::Union{Missing, GPBase}</code>: Either <code>Nothing</code> or a stored Gaussian process. See also <a href="ref.html#EquationLearning.fit_GP"><code>fit_GP</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/structs.jl#L11-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.Bootstrap_Setup" href="#EquationLearning.Bootstrap_Setup"><code>EquationLearning.Bootstrap_Setup</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Bootstrap_Setup</code></pre><p>A struct defining some arguments for <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>bootₓ::AbstractVector</code>: The spatial grid for bootstrapping.</li><li><code>bootₜ::AbstractVector</code>: The temporal grid for bootstrapping.</li><li><code>B::Int</code>: Number of bootstrap samples.</li><li><code>τ::Tuple{Float64, Float64}</code>: A tuple of the form <code>(τ₁, τ₂)</code> which gives the tolerance <code>τ₁</code> for thresholding <code>f</code> and <code>τ₂</code> for thresholding <code>fₜ</code>. See also <a href="index.html#EquationLearning.data_thresholder-Tuple{Any, Any, Any}"><code>data_thresholder</code></a>.</li><li><code>Optim_Restarts::Int</code>: Number of times to restart the optimiser for the nonlinear least squares problem. See also <a href="index.html#EquationLearning.learn_equations!-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Vararg{Any}}"><code>learn_equations!</code></a>.</li><li><code>constrained::Bool</code>: <code>true</code> if the optimisation problems should be constrained, and <code>false</code> otherwise.</li><li><code>obj_scale_GLS::Function</code>: The function determining how the GLS loss function should be scaled.</li><li><code>obj_scale_PDE::Function</code>: The function determining how the PDE loss function should be scaled.</li><li><code>init_weight::Float64</code>: Weight factor for the initial condition for the GLS errors.</li><li><code>show_losses::Bool</code>: <code>true</code> if the loss function should be printed to the REPL throughout the optimisation process, and <code>false</code> otherwise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/structs.jl#L68-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.PDE_Setup" href="#EquationLearning.PDE_Setup"><code>EquationLearning.PDE_Setup</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct PDE_Setup</code></pre><p>A struct defining some arguments for the PDEs in <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a> and <a href="ref"><code>boot_pde_solve</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>meshPoints::AbstractVector</code>: The spatial mesh to use for solving the PDEs involved when computing the <code>&quot;GLS&quot;</code> loss function, or for the PDEs in general.</li><li><code>LHS::Vector{Float64}</code>: Vector defining the left-hand boundary conditions for the PDE. See also the definitions of <code>(a₀, b₀, c₀)</code> in <a href="index.html#EquationLearning.sysdegeneral!-NTuple{4, Any}"><code>sysdegeneral!</code></a>.</li><li><code>RHS::Vector{Float64}</code>: Vector defining the right-hand boundary conditions for the PDE. See also the definitions of <code>(a₁, b₁, c₁)</code> in <a href="index.html#EquationLearning.sysdegeneral!-NTuple{4, Any}"><code>sysdegeneral!</code></a>.</li><li><code>finalTime::Float64</code>: The final time to solve the PDE up to.</li><li><code>δt::Union{AbstractVector, Float64}</code>: A number or a vector specifying the spacing between returned times for the solutions to the PDEs or specific times, respectively.</li><li><code>alg</code>: Algorithm to use for solving the PDEs. If you want to let <code>DifferentialEquations.jl</code> select the algorithm automatically, specify <code>alg = nothing</code>. If automatic differentiation is being used in the ODE algorithm, then no <code>Sundials</code> algorithms can be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/structs.jl#L129-L141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.BootResults" href="#EquationLearning.BootResults"><code>EquationLearning.BootResults</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct BootResults</code></pre><p>Structure for storing bootstrapping results. See <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>delayBases</code>: The estimated delay parameters. Each column corresponds to a single bootstrap iteration.</li><li><code>diffusionBases</code>: The estimated diffusion parameters. Each column corresponds to a single bootstrap iteration.</li><li><code>reactionBases</code>: The estimated reaction parameters. Each column corresponds to a single bootstrap iteration.</li><li><code>gp</code>: The fitted Gaussian process. See <a href="@ref"><code>fit_gp</code></a>.</li><li><code>zvals</code>: The simulated normal variables from <code>N(0, I)</code> used for drawing from the Gaussian process <code>gp</code>. See <a href="index.html#EquationLearning.draw_gp!-Tuple{Any, Any, LinearAlgebra.LowerTriangular, Any, Any}"><code>draw_gp!</code></a>.</li><li><code>Xₛ</code>: The test matrix for the bootstrapping grid data, given in the scale [0, 1].</li><li><code>Xₛⁿ</code>: The unscaled form of <code>Xₛ</code>.</li><li><code>bootₓ</code>: The spatial bootstrapping grid.</li><li><code>bootₜ</code>: The temporal bootstrapping grid.</li><li><code>T</code>: The delay function, given in the form <code>T(t, α, T_params)</code>.</li><li><code>D</code>: The diffusion function, given in the form <code>D(u, β, D_params)</code>.</li><li><code>D′</code>: The derivative of the diffusion function, given in the form <code>D′(u, β, D_params)</code>.</li><li><code>R</code>: The reaction function, given in the form <code>R(u, γ, R_params)</code>.</li><li><code>R′</code>: The derivative of the reaction function, given in the form <code>R′(u, γ, R_params)</code>.</li><li><code>D_params</code>: Parameters for the diffusion function.</li><li><code>R_params</code>: Parameters for the reaction function. </li><li><code>T_params</code>: Parameters for the delay function.</li><li><code>gp_setup</code>: The GP setup used; see <a href="ref.html#EquationLearning.GP_Setup"><code>GP_Setup</code></a>.</li><li><code>bootstrap_setup</code>: The bootstrap setup used; see <a href="@ref"><code>bootstrap_setup</code></a>.</li><li><code>pde_setup</code>: The PDE setup used; see <a href="@ref"><code>pde_setup</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/structs.jl#L180-L206">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.BasisBootResults" href="#EquationLearning.BasisBootResults"><code>EquationLearning.BasisBootResults</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct BasisBootResults</code></pre><p>Structure for storing bootstrapping results from the basis approach. See <a href="ref.html#EquationLearning.basis_bootstrap_gp"><code>basis_bootstrap_gp</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>diffusionBases</code>: The estimated diffusion parameters. Each column corresponds to a single bootstrap iteration.</li><li><code>reactionBases</code>: The estimated reaction parameters. Each column corresponds to a single bootstrap iteration.</li><li><code>gp</code>: The fitted Gaussian process. See <a href="@ref"><code>fit_gp</code></a>.</li><li><code>zvals</code>: The simulated normal variables from <code>N(0, I)</code> used for drawing from the Gaussian process <code>gp</code>. See <a href="index.html#EquationLearning.draw_gp!-Tuple{Any, Any, LinearAlgebra.LowerTriangular, Any, Any}"><code>draw_gp!</code></a>.</li><li><code>Xₛ</code>: The test matrix for the bootstrapping grid data, given in the scale [0, 1].</li><li><code>Xₛⁿ</code>: The unscaled form of <code>Xₛ</code>.</li><li><code>bootₓ</code>: The spatial bootstrapping grid.</li><li><code>bootₜ</code>: The temporal bootstrapping grid.</li><li><code>D</code>: The diffusion basis functions, each given in the form <code>φ(u, D_params)</code>.</li><li><code>D′</code>: The derivative of the diffusion basis functions.</li><li><code>R</code>: The reaction basis function, each given in the form <code>ψ(u, R_params)</code>.</li><li><code>R′</code>: The derivative of the reaction basis functions.</li><li><code>D_params</code>: Parameters for the diffusion function.</li><li><code>R_params</code>: Parameters for the reaction function. </li><li><code>gp_setup</code>: The GP setup used; see <a href="ref.html#EquationLearning.GP_Setup"><code>GP_Setup</code></a>.</li><li><code>bootstrap_setup</code>: The bootstrap setup used; see <a href="@ref"><code>bootstrap_setup</code></a>.</li><li><code>pde_setup</code>: The PDE setup used; see <a href="@ref"><code>pde_setup</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/structs.jl#L232-L255">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.AllResults" href="#EquationLearning.AllResults"><code>EquationLearning.AllResults</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct AllResults</code></pre><p>Helpful structure for displaying results. This differs from e.g. <a href="ref.html#EquationLearning.BootResults"><code>BootResults</code></a> since we also include PDE solutions.</p><p><strong>Fields</strong></p><ul><li><code>pde_solutions::Array{Float64}</code>: Solutions for the PDEs with sampled initial conditions.</li><li><code>AIC::Vector{Float64}</code>: The AICs.</li><li><code>bgp::Union{BootResults, BasisBootResults}</code>: Bootstrapping results.</li><li><code>delayCIs</code>: Confidence intervals for the delay parameters. </li><li><code>diffusionCIs</code>: Confidence intervals for the diffusion parameters. </li><li><code>reactionCIS</code>: Confidence intervals for the reaction parameters.</li><li><code>delay_density::Figure</code>: The density plots for the delay coefficients.</li><li><code>diffusion_density::Figure</code>: The density plots for the diffusion coefficients.</li><li><code>reaction_density::Figure</code>: The density plots for the reaction coefficients.</li><li><code>delay_curve::Figure</code>: Plot for the learned delay curve.</li><li><code>diffusion_curve::Figure</code>: Plot for the learned diffusion curve.</li><li><code>reaction_curve::Figure</code>: Plot for the learned reaction curve.</li><li><code>pde_plot::Figure</code>: Plot for the PDE solutions.</li><li><code>pde_error::Vector{Float64}</code>: Confidence interval for the PDE errors.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/structs.jl#L278-L298">source</a></section></article><h2 id="Bootstrapping"><a class="docs-heading-anchor" href="#Bootstrapping">Bootstrapping</a><a id="Bootstrapping-1"></a><a class="docs-heading-anchor-permalink" href="#Bootstrapping" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.bootstrap_gp" href="#EquationLearning.bootstrap_gp"><code>EquationLearning.bootstrap_gp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bootstrap_gp(x::T1, t::T1, u::T1,
    T::Function, D::Function, D′::Function, R::Function,
    α₀::T1, β₀::T1, γ₀::T1, lowers::T1, uppers::T1;
    gp_setup::GP_Setup = GP_Setup(u),
    bootstrap_setup::Bootstrap_Setup = Bootstrap_Setup(x, t, u),
    optim_setup::Optim.Options = Optim.Options(),
    pde_setup::PDE_Setup = PDE_Setup(x),
    D_params = nothing, R_params = nothing, T_params = nothing, zvals = nothing, PDEkwargs...) where {T1&lt;:AbstractVector}</code></pre><p>Perform bootstrapping on the data <code>(x, t, u)</code> to learn the appropriate functional forms of  <code>(T, D, R)</code> with uncertainty. </p><p><strong>Arguments</strong></p><ul><li><code>x::T1</code>: The spatial data.</li><li><code>t::T1</code>: The temporal data.</li><li><code>u::T1</code>: The density data.</li><li><code>T::Function: The delay function, given in the form</code>T(t, α, T_params)`.</li><li><code>D::Function</code>: The diffusion function, given in the form <code>D(u, β, D_params)</code>.</li><li><code>D′::Function</code>: The derivative of the diffusion function, given in the form <code>D′(u, β, D_params)</code>.</li><li><code>R::Function</code>: The reaction function, given in the form <code>R(u, γ, R_params)</code>.</li><li><code>R′::Function</code>: The derivative of the reaction function, given in the form <code>R′(u, γ, R_params)</code>.</li><li><code>α₀::T1</code>: Initial estimates of the delay parameters. Not actually used for anything other than ensuring the functions are specified correctly.</li><li><code>β₀::T1</code>: Initial estimates of the diffusion parameters. Not actually used for anything other than ensuring the functions are specified correctly. </li><li><code>γ₀::T1</code>: Initial estimates of the reaction parameters. Not actually used for anything other than ensuring the functions are specified correctly. </li><li><code>lowers::T1</code>: Lower bounds to use for constructing the Latin hypersquare design, and for the constrained problem if <code>constrained = true</code> in <code>bootstrap_setup</code>.</li><li><code>uppers::T1</code>: Upper bounds to use for constructing the Latin hypersquare design, and for the constrained problem if <code>constrained = true</code> in <code>bootstrap_setup</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>gp_setup::GP_Setup = GP_Setup(u)</code>: Defines the setup for the Gaussian process. See also <a href="ref.html#EquationLearning.GP_Setup"><code>GP_Setup</code></a>.</li><li><code>bootstart_setup::Bootstrap_Setup = Bootstrap_Setup(x, t, u)</code>: Defines some extra keyword arguments for the bootstrapping and optimisation process. See also <a href="ref.html#EquationLearning.Bootstrap_Setup"><code>Bootstrap_Setup</code></a>.</li><li><code>optim_setup::Optim.Options = Optim_Options()</code>: Defines some options when using <code>Optim.optimize</code>.</li><li><code>pde_setup::PDE_Setup = PDE_Setup(x)</code>: Defines some extra keyword arguments for the PDE solutions. See also <a href="ref.html#EquationLearning.PDE_Setup"><code>PDE_Setup</code></a>.</li><li><code>D_params = nothing</code>: Extra known parameters for the diffusion function <code>D</code>.</li><li><code>R_params = nothing</code>: Extra known parameters for the reaction function <code>R</code>.</li><li><code>T_params = nothing</code>: Extra known parameters for the delay function <code>T</code>.</li><li><code>PDEkwargs...</code>: Extra keyword arguments to use inside <code>DifferentialEquations.solve</code>.</li></ul><p><strong>Outputs</strong></p><ul><li><code>bgp</code>: A <code>BootResults</code> structure. See <a href="ref.html#EquationLearning.BootResults"><code>BootResults</code></a>. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/bootstrapping.jl#L324-L364">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.basis_bootstrap_gp" href="#EquationLearning.basis_bootstrap_gp"><code>EquationLearning.basis_bootstrap_gp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">basis_bootstrap_gp(x::T1, t::T1, u::T1,
    D::Vector{Function}, D′::Vector{Function}, R::Vector{Function}, R′::Vector{Function};
    gp_setup::GP_Setup = GP_Setup(u),
    bootstrap_setup::Bootstrap_Setup = Bootstrap_Setup(x, t, u),
    optim_setup::Optim.Options = Optim.Options(),
    pde_setup::PDE_Setup = PDE_Setup(x),
    D_params = nothing, R_params = nothing, PDEkwargs...) where {T1&lt;:AbstractVector}</code></pre><p>Perform bootstrapping on the data <code>(x, t, u)</code> to learn the appropriate functional forms of  <code>(T, D, R)</code> with uncertainty, using the basis function approach.</p><p><strong>Arguments</strong></p><ul><li><code>x::T1</code>: The spatial data.</li><li><code>t::T1</code>: The temporal data.</li><li><code>u::T1</code>: The density data.</li><li><code>D::Vector{Function}</code>: The diffusion function, given in the form <code>D(u, β, D_params)</code>.</li><li><code>D′::Vector{Function}</code>: The derivative of the diffusion function, given in the form <code>D′(u, β, D_params)</code>.</li><li><code>R::Vector{Function}</code>: The reaction function, given in the form <code>R(u, γ, R_params)</code>.</li><li><code>R′::Vector{Function}</code>: The derivative of the reaction function, given in the form <code>R′(u, γ, R_params)</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>gp_setup::GP_Setup = GP_Setup(u)</code>: Defines the setup for the Gaussian process. See also <a href="ref.html#EquationLearning.GP_Setup"><code>GP_Setup</code></a>.</li><li><code>bootstart_setup::Bootstrap_Setup = Bootstrap_Setup(x, t, u)</code>: Defines some extra keyword arguments for the bootstrapping and optimisation process. See also <a href="ref.html#EquationLearning.Bootstrap_Setup"><code>Bootstrap_Setup</code></a>.</li><li><code>pde_setup::PDE_Setup = PDE_Setup(x)</code>: Defines some extra keyword arguments for the PDE solutions. See also <a href="ref.html#EquationLearning.PDE_Setup"><code>PDE_Setup</code></a>.</li><li><code>D_params = nothing</code>: Extra known parameters for the diffusion function <code>D</code>.</li><li><code>R_params = nothing</code>: Extra known parameters for the reaction function <code>R</code>.</li><li><code>PDEkwargs...</code>: Extra keyword arguments to use inside <code>DifferentialEquations.solve</code>.</li></ul><p><strong>Outputs</strong></p><ul><li><code>bgp</code>: A <code>BasisBootResults</code> structure. See <a href="ref.html#EquationLearning.BasisBootResults"><code>BasisBootResults</code></a>. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/basis_bootstrapping.jl#L177-L208">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.update_results" href="#EquationLearning.update_results"><code>EquationLearning.update_results</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">update_results(bgp, bgp_new, mechanism)</code></pre><p>Updates the results in <code>bgp</code> with new results <code>bgp_new</code> for a re-estimated <code>mechanism</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/utils.jl#L112-L116">source</a></section></article><h2 id="Gaussian-Processes"><a class="docs-heading-anchor" href="#Gaussian-Processes">Gaussian Processes</a><a id="Gaussian-Processes-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-Processes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.fit_GP" href="#EquationLearning.fit_GP"><code>EquationLearning.fit_GP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit_GP(x, t, u; &lt;keyword arguments&gt;)</code></pre><p>Fits a Gaussian process with data <code>(x, t)</code> using the targets in <code>u</code>. </p><p><strong>Arguments</strong></p><ul><li><code>x</code>: The spatial data. </li><li><code>t</code>: The temporal data.</li><li><code>u</code>: The targets corresponding to <code>(x, t)</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>ℓₓ = log.([1e-4, 1.0])</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>ℓₓ</code> (defined on a log scale).</li><li><code>ℓₜ = log.([1e-4, 1.0])</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>ℓₜ</code> (defined on a log scale).</li><li><code>σ = log.([1e-1, 2std(u)])</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>σ</code> (defined on a log scale).</li><li><code>σₙ = log.([1e-5, 2std(u)])</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>σₙ</code> (defined on a log scale).</li><li><code>num_restarts = 50</code>: Number of times to restart the optimiser. See <a href="index.html#EquationLearning.opt_restart!-NTuple{5, Any}"><code>opt_restart!</code></a>.</li></ul><p><strong>Outputs</strong></p><ul><li><code>gp</code>: The fitted Gaussian process.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/gps.jl#L58-L77">source</a></section><section><div><pre><code class="language-julia hljs">fit_GP(x, t, u, setup::GP_Setup)</code></pre><p>Method for calling <a href="ref.html#EquationLearning.fit_GP"><code>fit_GP</code></a> with a setup defined by <a href="ref.html#EquationLearning.GP_Setup"><code>GP_Setup</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/gps.jl#L104-L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.compute_joint_GP" href="#EquationLearning.compute_joint_GP"><code>EquationLearning.compute_joint_GP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compute_joint_GP(gp::GPBase, X̃; nugget = 1e-10)</code></pre><p>Computes the mean vector <code>μ</code> and Cholesky factor <code>L</code> such that <code>LLᵀ = Σ</code>, where </p><p><span>$\left[\begin{array}{c} \mathbf{f} \\ \frac{\partial\mathbf f}{\partial t} \\ \frac{\partial\mathbf f}{\partial x} \\\frac{\partial^2\mathbf f}{\partial x^2}\end{array}\right] \sim \mathcal N\left(\mathbf{\mu}, \mathbf{\Sigma}\right).$</span></p><p><strong>Arguments</strong></p><ul><li><code>gp::GPBase</code>: The fitted Gaussian process. </li><li><code>X̃</code>: Test data for the Gaussian process. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>nugget = 1e-10</code>: The term to add to the diagonals of the covariance matrix in case the matrix is not positive definite.</li></ul><p><strong>Outputs</strong></p><ul><li><code>μ</code>: The mean vector. </li><li><code>L</code>: The Cholesky factor of the covariance matrix.</li></ul><p><strong>Extended help</strong></p><p>The covariance matrices are built without any attention to symmetry. The loops could be optimised by  e.g. considering only the upper triangular components. </p><p>The covariance matrices are built using separate functions for the derivatives of the kernel function (currently  only implemented for the squared exponential kernel). These functions are:</p><ul><li><a href="index.html#EquationLearning.dkxⱼ-NTuple{6, Any}"><code>dkxⱼ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d²kxⱼ-NTuple{6, Any}"><code>d²kxⱼ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.dktⱼ-NTuple{6, Any}"><code>dktⱼ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.dktᵢ-NTuple{6, Any}"><code>dktᵢ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d²ktᵢtⱼ-NTuple{6, Any}"><code>d²ktᵢtⱼ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d²ktᵢxⱼ-NTuple{6, Any}"><code>d²ktᵢxⱼ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d³tᵢxⱼ²-NTuple{6, Any}"><code>d³tᵢxⱼ²(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.dkxᵢ-NTuple{6, Any}"><code>dkxᵢ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d²kxᵢtⱼ-NTuple{6, Any}"><code>d²kxᵢtⱼ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d²kxᵢxⱼ-NTuple{6, Any}"><code>d²kxᵢxⱼ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d³kxᵢxⱼ²-NTuple{6, Any}"><code>d³kxᵢxⱼ²(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d²kxᵢ-NTuple{6, Any}"><code>d²kxᵢ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d³kxᵢ²tⱼ-NTuple{6, Any}"><code>d³kxᵢ²tⱼ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d³kxᵢ²xⱼ-NTuple{6, Any}"><code>d³kxᵢ²xⱼ(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li><li><a href="index.html#EquationLearning.d⁴kxᵢ²xⱼ²-NTuple{6, Any}"><code>d⁴kxᵢ²xⱼ²(x₁, t₁, x₂, t₂, ℓ₁, ℓ₂)</code></a>.</li></ul><p>In these functions, the derivatives are evaluated at <code>([x₁; t₁], [x₂; t₂])</code> with length scales  <code>(ℓ₁, ℓ₂)</code> for space and time, respectively. The functions are missing a multiplication by the  kernel value <code>cov(gp.kernel, [x₁; t₁], [x₂; t₂])</code> to allow for it to be done in place more easily.  Note also that in some of these functions, powers are written as products, e.g. <code>x³ = x*x*x</code>, to allow  for the <code>@muladd</code> macro to work (see https://github.com/SciML/MuladdMacro.jl). Since the functions are  quite small, we use <code>@inline</code> on each function to encourage the compiler to inline the function  in the LLVM.</p><p>You may get a <code>StackOverflowError</code> from this function. This may be related to https://github.com/JuliaLang/julia/issues/43242, in which case you can set the number of BLAS threads to 1:</p><pre><code class="language-julia-repl hljs">julia&gt; ccall((:openblas_get_num_threads64_, Base.libblas_name), Cint, ()) # In case you need to remember how many threads you used prior
julia&gt; LinearAlgebra.BLAS.set_num_threads(1)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/gps.jl#L159-L214">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.precompute_gp_mean" href="#EquationLearning.precompute_gp_mean"><code>EquationLearning.precompute_gp_mean</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">precompute_gp_mean(x, t, u, ℓₓ, ℓₜ, σ, σₙ, nugget, num_restarts, bootstrap_setup::Bootstrap_Setup)</code></pre><p>Computes the Gaussian process and corresponding mean vector and Cholesky factor for a  joint Gaussian process defined by the data <code>(x, t, u)</code>. See also  <a href="ref.html#EquationLearning.compute_joint_GP"><code>compute_joint_GP</code></a> and <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>: The spatial data. </li><li><code>t</code>: The temporal data.</li><li><code>u</code>: The targets corresponding to <code>(x, t)</code>.</li><li><code>ℓₓ</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>ℓₓ</code> (defined on a log scale).</li><li><code>ℓₜ</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>ℓₜ</code> (defined on a log scale).</li><li><code>σ</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>σ</code> (defined on a log scale).</li><li><code>σₙ</code>: A 2-vector giving the lower and upper bounds for the initial estimates of <code>σₙ</code> (defined on a log scale).</li><li><code>nugget</code>: The term to add to the diagonals of the covariance matrix in case the matrix is not positive definite.</li><li><code>num_restarts = 50</code>: Number of times to restart the optimiser. See <a href="index.html#EquationLearning.opt_restart!-NTuple{5, Any}"><code>opt_restart!</code></a>.</li><li><code>bootstrap_setup::Bootstrap_Setup</code>: A <a href="ref.html#EquationLearning.Bootstrap_Setup"><code>Bootstrap_Setup</code></a> struct for defining the bootstrapping grid.</li></ul><p><strong>Outputs</strong></p><ul><li><code>gp_setup</code>: The fitted Gaussian process.</li><li><code>μ</code>: The mean vector for the joint Gaussian proces.</li><li><code>L</code>: The Cholesky factor for the joint Gaussian process.</li></ul><p>`</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/gps.jl#L356-L380">source</a></section></article><h2 id="PDEs"><a class="docs-heading-anchor" href="#PDEs">PDEs</a><a id="PDEs-1"></a><a class="docs-heading-anchor-permalink" href="#PDEs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.boot_pde_solve" href="#EquationLearning.boot_pde_solve"><code>EquationLearning.boot_pde_solve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">boot_pde_solve(bgp::BootResults, x_pde, t_pde, u_pde; ICType = &quot;data&quot;)</code></pre><p>Solve the PDEs corresponding to the bootstrap iterates in <code>bgp</code> obtained from <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>. </p><p><strong>Arguments</strong></p><ul><li><code>bgp::BootResults</code>: A <a href="ref.html#EquationLearning.BootResults"><code>BootResults</code></a> struct containing the results from <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>.</li><li><code>x_pde</code>: The spatial data to use for obtaining the initial condition.</li><li><code>t_pde</code>: The temporal data to use for obtaining the initial condition.</li><li><code>u_pde</code>: The density data to use for obtaining the initial condition.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>ICType = &quot;data&quot;</code>: The type of initial condition to use. Should be either <code>&quot;data&quot;</code> or <code>&quot;gp&quot;</code>.</li></ul><p><strong>Outputs</strong></p><ul><li><code>solns_all</code>: The solutions to the PDEs over the mesh points at each time value.</li></ul><p><strong>Note</strong></p><p>The <code>_pde</code> subscript is used to indicate that these data need not be the same as the <code>(x, t, u)</code> used in <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>, for example. For example, we may have 3 replicates of some data which we would easily use in <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>, but for the PDE we would need to average these  together for obtaining the solutions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/pdes.jl#L200-L221">source</a></section><section><div><pre><code class="language-julia hljs">boot_pde_solve(bgp::BasisBootResults, x_pde, t_pde, u_pde, ICType = &quot;data&quot;)</code></pre><p>Solve the PDEs corresponding to the bootstrap iterates in <code>bgp</code> obtained from <a href="ref.html#EquationLearning.basis_bootstrap_gp"><code>basis_bootstrap_gp</code></a>. </p><p><strong>Arguments</strong></p><ul><li><code>bgp::BasisBootResults</code>: A <a href="ref.html#EquationLearning.BasisBootResults"><code>BasisBootResults</code></a> struct containing the results from <a href="ref.html#EquationLearning.basis_bootstrap_gp"><code>basis_bootstrap_gp</code></a>.</li><li><code>x_pde</code>: The spatial data to use for obtaining the initial condition.</li><li><code>t_pde</code>: The temporal data to use for obtaining the initial condition.</li><li><code>u_pde</code>: The density data to use for obtaining the initial condition.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>ICType = &quot;data&quot;</code>: The type of initial condition to use. Should be either <code>&quot;data&quot;</code> or <code>&quot;gp&quot;</code>.</li></ul><p><strong>Outputs</strong></p><ul><li><code>solns_all</code>: The solutions to the PDEs over the mesh points at each time value.</li></ul><p><strong>Note</strong></p><p>The <code>_pde</code> subscript is used to indicate that these data need not be the same as the <code>(x, t, u)</code> used in <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>, for example. For example, we may have 3 replicates of some data which we would easily use in <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a>, but for the PDE we would need to average these  together for obtaining the solutions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/basis_bootstrapping.jl#L381-L402">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.error_comp" href="#EquationLearning.error_comp"><code>EquationLearning.error_comp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">error_comp(bgp, solns_all, x, t, u; level = 0.05)</code></pre><p>Computes the error between solutions to a PDE compared to data <code>(x, t, u)</code> from the bootstrapping procedure. The error measure used is <code>median(100 * (absolute errors) / max(eps(Float64), u))</code>.</p><p><strong>Arguments</strong></p><ul><li><code>bgp</code>: Bootstrapping results.</li><li><code>solns_all</code>: PDE solutions.</li><li><code>x</code>: Spatial data.</li><li><code>t</code>: Temporal data.</li><li><code>u</code>: Density data.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: Level for the confidence interval.</li><li><code>compute_mean = false</code>: Whether to only report the mean.</li></ul><p><strong>Outputs</strong></p><ul><li><code>err_CI</code>: <code>100(1-level)%</code> confidence interval for the error.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/pdes.jl#L265-L284">source</a></section></article><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.density_values" href="#EquationLearning.density_values"><code>EquationLearning.density_values</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">density_values(bgp::BootResults; &lt;keyword arguments&gt;)</code></pre><p>Computes the densities for the bootstrapping results in <code>bgp</code>.</p><p><strong>Arguments</strong></p><ul><li><code>bgp</code>: A <a href="ref.html#EquationLearning.BootResults"><code>BootResults</code></a> object which contains the results for the bootstrapping. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li><li><code>fontsize = 23</code>: Font size for the plots (to be used in <a href="@ref"><code>plot_aes!</code></a>).</li><li><code>delay_scales = nothing</code>: Values that multiply the individual delay parameters.</li><li><code>diffusion_scales = nothing</code>: Values that multiply the individual diffusion parameters. </li><li><code>reaction_scales = nothing</code>: Values that multiply the individual reaction parameters.</li></ul><p><strong>Outputs</strong></p><ul><li><code>trv</code>: Delay densities.</li><li><code>dr</code>: Diffusion densities. </li><li><code>rr</code>: Reaction densities. </li><li><code>tt</code>: Number of delay parameters.</li><li><code>d</code>: Number of diffusion parameters.</li><li><code>r</code>: Number of reaction parameters. </li><li><code>delayCIs</code>: Confidence intervals for the delay parameters. </li><li><code>diffusionCIs</code>: Confidence intervals for the diffusion parameters. </li><li><code>reactionCIS</code>: Confidence intervals for the reaction parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/plot_results.jl#L9-L34">source</a></section><section><div><pre><code class="language-julia hljs">density_values(bgp::BasisBootResults; &lt;keyword arguments&gt;)</code></pre><p>Computes the densities for the bootstrapping results in <code>bgp</code> from a basis function approach.</p><p><strong>Arguments</strong></p><ul><li><code>bgp</code>: A <a href="ref.html#EquationLearning.BasisBootResults"><code>BasisBootResults</code></a> object which contains the results for the bootstrapping. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li><li><code>fontsize = 23</code>: Font size for the plots (to be used in <a href="@ref"><code>plot_aes!</code></a>).</li><li><code>diffusion_scales = nothing</code>: Values that multiply the individual diffusion parameters. </li><li><code>reaction_scales = nothing</code>: Values that multiply the individual reaction parameters.</li></ul><p><strong>Outputs</strong></p><ul><li><code>dr</code>: Diffusion densities. </li><li><code>rr</code>: Reaction densities. </li><li><code>d</code>: Number of diffusion parameters.</li><li><code>r</code>: Number of reaction parameters. </li><li><code>delayCIs</code>: Confidence intervals for the delay parameters. </li><li><code>diffusionCIs</code>: Confidence intervals for the diffusion parameters. </li><li><code>reactionCIS</code>: Confidence intervals for the reaction parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/basis_bootstrapping.jl#L447-L469">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.density_results" href="#EquationLearning.density_results"><code>EquationLearning.density_results</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">density_results(bgp::BootResults; &lt;keyword arguments&gt;)</code></pre><p>Plots the densities for the bootstrapping results in <code>bgp</code>.</p><p><strong>Arguments</strong></p><ul><li><code>bgp</code>: A <a href="ref.html#EquationLearning.BootResults"><code>BootResults</code></a> object which contains the results for the bootstrapping. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li><li><code>fontsize = 23</code>: Font size for the plots (to be used in <a href="@ref"><code>plot_aes!</code></a>).</li><li><code>delay_scales = nothing</code>: Values that multiply the individual delay parameters.</li><li><code>diffusion_scales = nothing</code>: Values that multiply the individual diffusion parameters. </li><li><code>reaction_scales = nothing</code>: Values that multiply the individual reaction parameters.</li><li><code>diffusion_resolution = (800, 800)</code>: Resolution for the diffusion figure.</li><li><code>reaction_resolution = (800, 800)</code>: Resolution for the reaction figure.</li><li><code>delay_resolution = (800, 800)</code>: Resolution for the delay fgure.</li></ul><p><strong>Outputs</strong></p><ul><li><code>delayDensityFigure</code>: A figure of plots containing a density plot for each delay parameter.</li><li><code>diffusionDensityFigure</code>: A figure of plots containing a density plot for each diffusion parameter.</li><li><code>reactionDensityFigure</code>: A figure of plots containing a density plot for each reaction parameter.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/plot_results.jl#L84-L106">source</a></section><section><div><pre><code class="language-julia hljs">density_results(bgp::BasisBootResults; &lt;keyword arguments&gt;)</code></pre><p>Plots the densities for the bootstrapping results in <code>bgp</code> with the basis function approach.</p><p><strong>Arguments</strong></p><ul><li><code>bgp</code>: A <a href="ref.html#EquationLearning.BasisBootResults"><code>BasisBootResults</code></a> object which contains the results for the bootstrapping. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li><li><code>fontsize = 23</code>: Font size for the plots (to be used in <a href="@ref"><code>plot_aes!</code></a>).</li><li><code>diffusion_scales = nothing</code>: Values that multiply the individual diffusion parameters. </li><li><code>reaction_scales = nothing</code>: Values that multiply the individual reaction parameters.</li><li><code>diffusion_resolution = (800, 800)</code>: Resolution for the diffusion figure.</li><li><code>reaction_resolution = (800, 800)</code>: Resolution for the reaction figure.</li></ul><p><strong>Outputs</strong></p><ul><li><code>diffusionDensityFigure</code>: A figure of plots containing a density plot for each diffusion parameter.</li><li><code>reactionDensityFigure</code>: A figure of plots containing a density plot for each reaction parameter.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/basis_bootstrapping.jl#L504-L523">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.curve_values" href="#EquationLearning.curve_values"><code>EquationLearning.curve_values</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">curve_values(bgp::BootResults; &lt;keyword arguments&gt;)</code></pre><p>Computes values for plotting the learned functional forms along with confidence intervals for the bootstrapping results in <code>bgp</code>.</p><p><strong>Arguments</strong></p><ul><li><code>bgp</code>: A <a href="ref.html#EquationLearning.BootResults"><code>BootResults</code></a> object which contains the results for the bootstrapping. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li><li><code>x_scale = 1.0</code>: Value used for scaling the spatial data (and all other length units, e.g. for diffusion).</li><li><code>t_scale = 1.0</code>: Value used for scaling the temporal data (and all other time units, e.g. for reaction).</li></ul><p><strong>Outputs</strong></p><ul><li><code>Tu_vals</code>: Ribbon features for the delay functions. </li><li><code>Du_vals</code>: Ribbon features for the diffusion functions.</li><li><code>Ru_vals</code>: Ribbon features for the reaction functions.</li><li><code>u_vals</code>: The density values used for computing the functions. </li><li><code>t_vals</code>: The time values used for computing the functions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/plot_results.jl#L158-L177">source</a></section><section><div><pre><code class="language-julia hljs">curve_values(bgp::BasisBootResults; &lt;keyword arguments&gt;)</code></pre><p>Computes values for plotting the learned functional forms along with confidence intervals for the bootstrapping results in <code>bgp</code> from the basis function approach.</p><p><strong>Arguments</strong></p><ul><li><code>bgp</code>: A <a href="ref.html#EquationLearning.BasisBootResults"><code>BasisBootResults</code></a> object which contains the results for the bootstrapping. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li><li><code>x_scale = 1.0</code>: Value used for scaling the spatial data (and all other length units, e.g. for diffusion).</li><li><code>t_scale = 1.0</code>: Value used for scaling the temporal data (and all other time units, e.g. for reaction).</li></ul><p><strong>Outputs</strong></p><ul><li><code>Du_vals</code>: Ribbon features for the diffusion functions.</li><li><code>Ru_vals</code>: Ribbon features for the reaction functions.</li><li><code>u_vals</code>: The density values used for computing the functions. </li><li><code>t_vals</code>: The time values used for computing the functions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/basis_bootstrapping.jl#L562-L580">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.curve_results" href="#EquationLearning.curve_results"><code>EquationLearning.curve_results</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">curve_results(bgp::BootResults; &lt;keyword arguments&gt;)</code></pre><p>Plots the learned functional forms along with confidence intervals for the bootstrapping results in <code>bgp</code>.</p><p><strong>Arguments</strong></p><ul><li><code>bgp</code>: A <a href="ref.html#EquationLearning.BootResults"><code>BootResults</code></a> object which contains the results for the bootstrapping. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li><li><code>fontsize = 23</code>: Font size for the plots (to be used in <a href="@ref"><code>plot_aes!</code></a>).</li><li><code>x_scale = 1.0</code>: Value used for scaling the spatial data (and all other length units, e.g. for diffusion).</li><li><code>t_scale = 1.0</code>: Value used for scaling the temporal data (and all other time units, e.g. for reaction).</li></ul><p><strong>Outputs</strong></p><ul><li><code>delayCurvePlots</code>: A plot containing the learned functional form for the delay function, along with an uncertainty ribbon.</li><li><code>diffusionCurvePlots</code>: A plot containing the learned functional form for the diffusion function, along with an uncertainty ribbon.</li><li><code>reactionCurvePlots</code>: A plot containing the learned functional form for the reaction function, along with an uncertainty ribbon.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/plot_results.jl#L208-L226">source</a></section><section><div><pre><code class="language-julia hljs">curve_results(bgp::BasisBootResults; &lt;keyword arguments&gt;)</code></pre><p>Plots the learned functional forms along with confidence intervals for the bootstrapping results in <code>bgp</code> from the basis function approach.</p><p><strong>Arguments</strong></p><ul><li><code>bgp</code>: A <a href="ref.html#EquationLearning.BasisBootResults"><code>BasisBootResults</code></a> object which contains the results for the bootstrapping. </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li><li><code>fontsize = 23</code>: Font size for the plots (to be used in <a href="@ref"><code>plot_aes!</code></a>).</li><li><code>x_scale = 1.0</code>: Value used for scaling the spatial data (and all other length units, e.g. for diffusion).</li><li><code>t_scale = 1.0</code>: Value used for scaling the temporal data (and all other time units, e.g. for reaction).</li></ul><p><strong>Outputs</strong></p><ul><li><code>diffusionCurvePlots</code>: A plot containing the learned functional form for the diffusion function, along with an uncertainty ribbon.</li><li><code>reactionCurvePlots</code>: A plot containing the learned functional form for the reaction function, along with an uncertainty ribbon.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/basis_bootstrapping.jl#L605-L622">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.pde_values" href="#EquationLearning.pde_values"><code>EquationLearning.pde_values</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function pde_values(solns_all, bgp::Union{BootResults, BasisBootResults}; level = 0.05)</code></pre><p>Plots the solutions to the PDEs corresponding to the bootstrap samples of <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a> using  the computed solutins in <a href="ref.html#EquationLearning.boot_pde_solve"><code>boot_pde_solve</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>solns_all</code>: The solutions to the PDEs for each bootstrap iteration. </li><li><code>bgp::Union{BootResults, BasisBootResults}</code>: Bootstrapping results.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li></ul><p><strong>Outputs</strong></p><ul><li><code>soln_vals_mean</code>: Mean solution values. </li><li><code>soln_vals_lowers</code>: Lower confidence interval for solution values.</li><li><code>soln_vals_upper</code>: Upper confidence interval for solution values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/plot_results.jl#L253-L270">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.pde_results" href="#EquationLearning.pde_results"><code>EquationLearning.pde_results</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pde_results(x_pde, t_pde u_pde, solns_all, bgp::Union{BootResults, BasisBootResults}; &lt;keyword arguments&gt;)</code></pre><p>Plots the solutions to the PDEs corresponding to the bootstrap samples of <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a> using  the computed solutins in <a href="ref.html#EquationLearning.boot_pde_solve"><code>boot_pde_solve</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>x_pde</code>: The spatial data to plot as points.</li><li><code>t_pde</code>: The temporal data to plot as points.</li><li><code>u_pde</code>: The density data to plot as points. </li><li><code>solns_all</code>: The solutions to the PDEs for each bootstrap iteration. </li><li><code>bgp::Union{BootResults, BasisBootResults}</code>: A <a href="ref.html#EquationLearning.BootResults"><code>BootResults</code></a> or <a href="ref.html#EquationLearning.BasisBootResults"><code>BasisBootResults</code></a> struct containing the results from <a href="ref.html#EquationLearning.bootstrap_gp"><code>bootstrap_gp</code></a> or <a href="ref.html#EquationLearning.basis_bootstrap_gp"><code>basis_bootstrap_gp</code></a>, respectively.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>colors = [:black, :blue, :red, :magenta, :green]</code>: A list of colors for colouring the solutions at each time.</li><li><code>level = 0.05</code>: The significance level for computing the credible intervals for the parameter values. </li><li><code>fontsize = 23</code>: Font size for the plots (to be used in <a href="@ref"><code>plot_aes!</code></a>).</li><li><code>x_scale = 1.0</code>: Value used for scaling the spatial data (and all other length units, e.g. for diffusion).</li><li><code>t_scale = 1.0</code>: Value used for scaling the temporal data (and all other time units, e.g. for reaction).`</li></ul><p><strong>Outputs</strong></p><ul><li><code>pdeSolutionPlots_BGP</code>: The plot of the PDE solutions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/plot_results.jl#L283-L305">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.delay_product" href="#EquationLearning.delay_product"><code>EquationLearning.delay_product</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">delay_product(bgp, t; type = &quot;diffusion&quot;, level = 0.05, x_scale = 1.0, t_scale = 1.0)</code></pre><p>Computes the curve <code>T(t; α)D(u; β)</code> (if <code>type = &quot;diffusion&quot;</code>) or <code>T(t; β)R(u; γ)</code> (if <code>type = &quot;reaction&quot;</code>) with uncertainty for the results in <code>bgp</code>, at the time <code>t</code>. The significance level is determined by <code>level</code> (<code>0.05</code> default) and the spatial and temporal data are scaled by <code>x_scale</code> (<code>1.0</code> default) and <code>t_scale</code> (<code>1.0</code> default), respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/plot_results.jl#L328-L334">source</a></section></article><h2 id="Data-Generation"><a class="docs-heading-anchor" href="#Data-Generation">Data Generation</a><a id="Data-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Generation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.generate_data" href="#EquationLearning.generate_data"><code>EquationLearning.generate_data</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_data(x₀, u₀, T, D, R, α, β, γ, δt, finalTime; &lt;keyword arguments&gt;)</code></pre><p>Generate synthetic data from values <code>(x₀, t₀)</code> at <code>t = 0</code> with exact mechanisms <code>T</code>, <code>D</code>, and <code>R</code> for delay, diffusion, and reaction, respectively. </p><p><strong>Arguments</strong></p><ul><li><code>x₀</code>: The spatial mesh for points at <code>t = 0</code>.</li><li><code>u₀</code>: The density values at <code>t = 0</code> corresponding to the points in <code>x₀</code>.</li><li><code>T</code>: A delay function of the form <code>T(t, α, T_params)</code>.</li><li><code>D</code>: A diffusion function of the form <code>D(u, β, D_params)</code>.</li><li><code>R</code>: A reaction function of the form <code>R(u, γ, R_params)</code>.</li><li><code>D′</code>: The derivative of the diffusion function, given in the form <code>D′(u, β, D_params)</code>.</li><li><code>R′</code>: The reaction function, given in the form <code>R(u, γ, R_params)</code>.</li><li><code>α</code>: Exact values for the delay parameters.</li><li><code>β</code>: Exact values for the diffusion parameters.</li><li><code>γ</code>: Exact values for the reaction parameters. </li><li><code>δt</code>: Times to save the solution to the differential equations at for generating the data.</li><li><code>finalTime</code>: The time to solve the differential equations up to.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>N = 1000</code>: The number of mesh points to use.</li><li><code>LHS = [0.0, 1.0, 0.0]</code>: Vector defining the left-hand boundary conditions for the PDE. See also the definitions of <code>(a₀, b₀, c₀)</code> in <a href="index.html#EquationLearning.sysdegeneral!-NTuple{4, Any}"><code>sysdegeneral!</code></a>.</li><li><code>RHS = [0.0, -1.0, 0.0]</code>: Vector defining the right-hand boundary conditions for the PDE. See also the definitions of <code>(a₁, b₁, c₁)</code> in <a href="index.html#EquationLearning.sysdegeneral!-NTuple{4, Any}"><code>sysdegeneral!</code></a>.</li><li><code>alg = nothing</code>: The algorithm to use for solving the differential equations.</li><li><code>N_thin = 100</code>: The number of points to take from the solution at each time.</li><li><code>num_restarts = 50</code>: The number of times to restart the optimiser for fitting the Gaussian process to the data.</li><li><code>D_params</code>: Additional known parameters for the diffusion function.</li><li><code>R_params</code>: Additional known parameters for the reaction function.</li><li><code>T_params</code>: Additional known parameters for the delay function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/synthetic_data.jl#L8-L38">source</a></section></article><h2 id="Model-Comparison"><a class="docs-heading-anchor" href="#Model-Comparison">Model Comparison</a><a id="Model-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Comparison" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.AIC" href="#EquationLearning.AIC"><code>EquationLearning.AIC</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AIC(bgp::Union{BootResults, BasisBootResults}; correct = true)</code></pre><p>Computes all the AIC values for the results in <code>bgp</code>. A small-sample size correction is used  if <code>correct = true</code>. The formulas used are given in Eq. 6 (uncorrected) or Eq. 17 (corrected) of Banks and Joyner (2017) [https://doi.org/10.1016/j.aml.2017.05.005].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/comparison.jl#L9-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquationLearning.compare_AICs" href="#EquationLearning.compare_AICs"><code>EquationLearning.compare_AICs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compare_AICs(AICs::Float64...)</code></pre><p>Compares the AIC values in <code>AICs...</code>. See also <a href="index.html#EquationLearning.classify_Δᵢ-Tuple{Float64}"><code>classify_Δᵢ</code></a> and <a href="ref.html#EquationLearning.AIC"><code>AIC</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/comparison.jl#L78-L82">source</a></section><section><div><pre><code class="language-julia hljs">compare_AICs(AICs::Vector{Float64}...)</code></pre><p>Compares many AICs by comparing entry-wise. The results are averaged. Assumes that each AIC is of equal length,  otherwise computes only up to the minimum length. The returned value is such that the <code>(i, j)</code> entry  gives the proportion of times that model <code>i</code> has been given interpretation <code>j</code> from <a href="index.html#EquationLearning.classify_Δᵢ-Tuple{Float64}"><code>classify_Δᵢ</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/comparison.jl#L89-L95">source</a></section><section><div><pre><code class="language-julia hljs">compare_AICs(x, t, u, models::Union{BootResults, BasisBootResults}...; correct = true)</code></pre><p>Compare several bootstrapped models using AIC.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DanielVandH/EquationLearning.jl/blob/43eae601ca1189f3ab2dcdcfea946522e5bfa1c9/src/comparison.jl#L111-L115">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="tut.html">« Tutorial</a><a class="docs-footer-nextpage" href="index.html">Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Friday 29 July 2022 00:42">Friday 29 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
